(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15760,        364]
NotebookOptionsPosition[     14291,        325]
NotebookOutlinePosition[     14647,        341]
CellTagsIndexPosition[     14604,        338]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.715502399622534*^9, 
  3.715502416673644*^9}},ExpressionUUID->"211c148f-e3a3-4863-b726-\
8f62e589388b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rsaCracker", "[", 
    RowBox[{"cipher_", ",", "n_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "storeAscii", ",", "messageFromSomeone", ",", "q", ",", "ascii", ",", 
       "storePrime", ",", "pSomebody", ",", "qSomebody", ",", "phiSomebody", 
       "\[IndentingNewLine]", ",", "dSomebody", ",", "x"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Array", "[", 
       RowBox[{"storePrime", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Array", "[", 
       RowBox[{"storeAscii", ",", 
        RowBox[{"Length", "[", "cipher", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"storePrime", " ", "=", 
       RowBox[{"FactorInteger", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pSomebody", " ", "=", " ", 
       RowBox[{"First", "[", 
        RowBox[{"First", "[", "storePrime", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"qSomebody", " ", "=", " ", 
       RowBox[{"First", "[", 
        RowBox[{"Last", "[", "storePrime", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phiSomebody", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pSomebody", "-", "1"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"qSomebody", "-", "1"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dSomebody", "=", 
       RowBox[{"PowerMod", "[", 
        RowBox[{"e", ",", 
         RowBox[{"-", "1"}], ",", "phiSomebody"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"messageFromSomeone", " ", "=", " ", 
         RowBox[{"PowerMod", "[", 
          RowBox[{
           RowBox[{"cipher", "[", 
            RowBox[{"[", "x", "]"}], "]"}], ",", "dSomebody", ",", "n"}], 
          "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"x", "=", "1"}], ",", 
          RowBox[{"x", " ", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", "cipher", "]"}]}], ",", 
          RowBox[{"x", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"messageFromSomeone", " ", "=", " ", 
            RowBox[{"PowerMod", "[", 
             RowBox[{
              RowBox[{"cipher", "[", 
               RowBox[{"[", "x", "]"}], "]"}], ",", "dSomebody", ",", "n"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "messageFromSomeone", "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "q"}], "=", 
       "messageFromSomeone"}], ";", 
      RowBox[{"ascii", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"q", "\[NotEqual]", " ", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"ascii", ",", 
            RowBox[{"Mod", "[", 
             RowBox[{"q", ",", "256"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"q", "=", " ", 
           RowBox[{"Quotient", "[", 
            RowBox[{"q", ",", "256"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], "ascii", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "ascii", "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.715415946669201*^9, 3.715415976574108*^9}, {
   3.715416044979538*^9, 3.715416057377338*^9}, {3.71541644263446*^9, 
   3.715416476710485*^9}, {3.715416574218665*^9, 3.715416600319108*^9}, {
   3.71541665965108*^9, 3.715416661514834*^9}, {3.715416703943614*^9, 
   3.715416794501807*^9}, {3.715417118064979*^9, 3.715417165716963*^9}, {
   3.7154172056635933`*^9, 3.71541722672726*^9}, {3.715417381815716*^9, 
   3.715417442923403*^9}, {3.715417576163848*^9, 3.715417588505846*^9}, {
   3.715417675309064*^9, 3.715417676411278*^9}, {3.715417861125288*^9, 
   3.715417998683488*^9}, {3.7154180903675337`*^9, 3.715418161187439*^9}, {
   3.715426460799341*^9, 3.715426503546775*^9}, {3.715426610853544*^9, 
   3.7154266300907784`*^9}, {3.715426679304736*^9, 3.71542672528456*^9}, {
   3.715426769984275*^9, 3.715426806860896*^9}, {3.715426872525125*^9, 
   3.7154270138023443`*^9}, {3.715427097854826*^9, 3.715427138595639*^9}, {
   3.715427185764554*^9, 3.715427190468711*^9}, {3.715440673098895*^9, 
   3.715440677151751*^9}, {3.7154407098267508`*^9, 3.71544080507229*^9}, {
   3.715440947944343*^9, 3.7154410229451437`*^9}, {3.715441055977972*^9, 
   3.715441095058079*^9}, {3.7154411738597507`*^9, 3.7154412895248623`*^9}, {
   3.7154413585366297`*^9, 3.715441549592608*^9}, {3.7154416212588873`*^9, 
   3.715441822011321*^9}, {3.715441874127314*^9, 3.715441915359481*^9}, 
   3.71544195652779*^9, {3.715442015131866*^9, 3.7154420380424757`*^9}, {
   3.7154420994334183`*^9, 3.715442125999988*^9}, {3.715442160691904*^9, 
   3.715442162267523*^9}, {3.7154421946318617`*^9, 3.7154423502914267`*^9}, {
   3.715500887834621*^9, 3.7155009048479652`*^9}, {3.715502436142807*^9, 
   3.715502458916766*^9}, {3.715502503689067*^9, 3.715502519450265*^9}, {
   3.715502907220511*^9, 3.715502959698516*^9}, {3.715503099158738*^9, 
   3.715503144922038*^9}, {3.715503184957082*^9, 3.715503185212236*^9}, {
   3.715503234017029*^9, 3.7155032643665333`*^9}, {3.715503318446773*^9, 
   3.715503326748488*^9}, {3.7155034417439203`*^9, 3.715503831959937*^9}, {
   3.715503925535569*^9, 3.7155039582052107`*^9}, {3.7155042704748583`*^9, 
   3.715504278352861*^9}, {3.7155094484237337`*^9, 3.715509458101665*^9}, {
   3.715509590204133*^9, 
   3.715509611056654*^9}},ExpressionUUID->"bcf1e579-fe1f-4307-8b76-\
3f6471f9035d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<`*\>\"", 
  "]"}], "\[IndentingNewLine]", "\"\<Q\>\"", "\[IndentingNewLine]", 
 RowBox[{"q", "=", 
  RowBox[{"NextPrime", "[", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["10", "15"], ",", 
      SuperscriptBox["10", "20"]}], "}"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", "\"\<P\>\"", "\[IndentingNewLine]", 
 RowBox[{"p", "=", 
  RowBox[{"NextPrime", "[", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["10", "15"], ",", 
      SuperscriptBox["10", "20"]}], "}"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", "\"\<N\>\"", "\[IndentingNewLine]", 
 RowBox[{"n", " ", "=", " ", 
  RowBox[{"p", "*", "q"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p", "-", "1"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{"q", "-", "1"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rnd", ":=", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["10", "3"], ",", 
      SuperscriptBox["10", "4"]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{"GCD", "[", 
     RowBox[{
      RowBox[{"e", "=", "rnd"}], ",", "phi"}], "]"}], "\[NotEqual]", "1"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"e", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", " ", "256"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"PowerMod", "[", 
    RowBox[{"e", ",", 
     RowBox[{"-", "1"}], ",", "phi"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "message", " ", "=", " ", "\"\<DISKRET MATTE, DE E FETT NAIS:\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ascii", "=", 
   RowBox[{"ToCharacterCode", "[", "message", "]"}]}], 
  ";"}], "\[IndentingNewLine]", "\"\<Cipher\>\"", "\[IndentingNewLine]", 
 RowBox[{"cipher", " ", "=", " ", 
  RowBox[{"PowerMod", "[", 
   RowBox[{"ascii", ",", "n", ",", "e"}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.715507746758225*^9, 3.715507768856638*^9}, {
   3.7155079197313833`*^9, 3.71550810812754*^9}, {3.715508145479948*^9, 
   3.715508151878677*^9}, 3.715508518885914*^9, {3.715508943563478*^9, 
   3.7155089754087353`*^9}, 3.7155090057445087`*^9, 3.7155090581758623`*^9, {
   3.7155091138710423`*^9, 3.715509161419774*^9}, {3.7155092271485453`*^9, 
   3.715509233545701*^9}, {3.715509270050726*^9, 3.7155093070156183`*^9}, {
   3.715509370185934*^9, 3.715509389605431*^9}, {3.715509570747995*^9, 
   3.7155095727938747`*^9}, {3.715570948864653*^9, 3.715570955290469*^9}, {
   3.715571017555336*^9, 3.715571071447435*^9}, {3.715571139112246*^9, 
   3.71557124472379*^9}, {3.7155712764468613`*^9, 3.715571333128522*^9}, {
   3.715571419287245*^9, 3.71557143408606*^9}, 3.7155715424281397`*^9, 
   3.715571584754052*^9, {3.71557208722433*^9, 3.715572097197423*^9}, {
   3.715572162563882*^9, 3.715572171986156*^9}, {3.715572237896141*^9, 
   3.7155723883942947`*^9}, {3.71557244453611*^9, 3.715572451708436*^9}, {
   3.715572519066144*^9, 3.715572540351555*^9}, {3.715572616334302*^9, 
   3.715572621246047*^9}, {3.715573061619989*^9, 3.715573104072815*^9}, {
   3.715573134161378*^9, 3.715573346173689*^9}, {3.715573494487384*^9, 
   3.715573524157751*^9}, {3.7155735758715343`*^9, 3.7155736400370913`*^9}, {
   3.715573724730276*^9, 3.715573752663578*^9}, {3.71557379437672*^9, 
   3.715573872988352*^9}, {3.715574929073516*^9, 3.715574999232149*^9}, {
   3.715575055457336*^9, 
   3.715575128429604*^9}},ExpressionUUID->"8afb3927-b920-4bec-9b3c-\
f1fd4d6f7b78"],

Cell[BoxData["\<\"Q\"\>"], "Output",
 CellChangeTimes->{
  3.715572390336316*^9, {3.715573306328601*^9, 3.715573346870208*^9}, {
   3.715573574434841*^9, 3.715573631590695*^9}, 3.71557375309727*^9, {
   3.715573813155079*^9, 3.715573874360774*^9}, {3.7155749660812073`*^9, 
   3.715574983662752*^9}, {3.715575051088043*^9, 
   3.715575129609761*^9}},ExpressionUUID->"8815a84e-6538-4a46-b6f5-\
dabc3dd98996"],

Cell[BoxData["88580825397994757167"], "Output",
 CellChangeTimes->{
  3.715572390336316*^9, {3.715573306328601*^9, 3.715573346870208*^9}, {
   3.715573574434841*^9, 3.715573631590695*^9}, 3.71557375309727*^9, {
   3.715573813155079*^9, 3.715573874360774*^9}, {3.7155749660812073`*^9, 
   3.715574983662752*^9}, {3.715575051088043*^9, 
   3.71557512962082*^9}},ExpressionUUID->"39710e87-40d7-4ffa-ac43-\
6d198717baae"],

Cell[BoxData["\<\"P\"\>"], "Output",
 CellChangeTimes->{
  3.715572390336316*^9, {3.715573306328601*^9, 3.715573346870208*^9}, {
   3.715573574434841*^9, 3.715573631590695*^9}, 3.71557375309727*^9, {
   3.715573813155079*^9, 3.715573874360774*^9}, {3.7155749660812073`*^9, 
   3.715574983662752*^9}, {3.715575051088043*^9, 
   3.715575129627248*^9}},ExpressionUUID->"c418f330-b4e6-4949-bfe5-\
83b812570087"],

Cell[BoxData["97743840080927636669"], "Output",
 CellChangeTimes->{
  3.715572390336316*^9, {3.715573306328601*^9, 3.715573346870208*^9}, {
   3.715573574434841*^9, 3.715573631590695*^9}, 3.71557375309727*^9, {
   3.715573813155079*^9, 3.715573874360774*^9}, {3.7155749660812073`*^9, 
   3.715574983662752*^9}, {3.715575051088043*^9, 
   3.715575129633587*^9}},ExpressionUUID->"87c2b33e-e702-4af2-a1ae-\
e9458d7e60c2"],

Cell[BoxData["\<\"N\"\>"], "Output",
 CellChangeTimes->{
  3.715572390336316*^9, {3.715573306328601*^9, 3.715573346870208*^9}, {
   3.715573574434841*^9, 3.715573631590695*^9}, 3.71557375309727*^9, {
   3.715573813155079*^9, 3.715573874360774*^9}, {3.7155749660812073`*^9, 
   3.715574983662752*^9}, {3.715575051088043*^9, 
   3.715575129639955*^9}},ExpressionUUID->"63edc929-4e27-4d78-928f-\
088dd25a94c1"],

Cell[BoxData["8658230031938172719019148309177859756723"], "Output",
 CellChangeTimes->{
  3.715572390336316*^9, {3.715573306328601*^9, 3.715573346870208*^9}, {
   3.715573574434841*^9, 3.715573631590695*^9}, 3.71557375309727*^9, {
   3.715573813155079*^9, 3.715573874360774*^9}, {3.7155749660812073`*^9, 
   3.715574983662752*^9}, {3.715575051088043*^9, 
   3.715575129646405*^9}},ExpressionUUID->"154dec27-654b-4741-a844-\
62d9aae99876"],

Cell[BoxData["\<\"Cipher\"\>"], "Output",
 CellChangeTimes->{
  3.715572390336316*^9, {3.715573306328601*^9, 3.715573346870208*^9}, {
   3.715573574434841*^9, 3.715573631590695*^9}, 3.71557375309727*^9, {
   3.715573813155079*^9, 3.715573874360774*^9}, {3.7155749660812073`*^9, 
   3.715574983662752*^9}, {3.715575051088043*^9, 
   3.7155751296533012`*^9}},ExpressionUUID->"7d630e82-2d81-435b-aad1-\
45a5843f863f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3503", ",", "1438", ",", "1045", ",", "2592", ",", "1295", ",", "1946", 
   ",", "620", ",", "3240", ",", "529", ",", "4325", ",", "620", ",", "620", 
   ",", "1946", ",", "229", ",", "3240", ",", "3503", ",", "1946", ",", 
   "3240", ",", "1946", ",", "3240", ",", "2424", ",", "1946", ",", "620", 
   ",", "620", ",", "3240", ",", "4147", ",", "4325", ",", "1438", ",", 
   "1045", ",", "4371"}], "}"}]], "Output",
 CellChangeTimes->{
  3.715572390336316*^9, {3.715573306328601*^9, 3.715573346870208*^9}, {
   3.715573574434841*^9, 3.715573631590695*^9}, 3.71557375309727*^9, {
   3.715573813155079*^9, 3.715573874360774*^9}, {3.7155749660812073`*^9, 
   3.715574983662752*^9}, {3.715575051088043*^9, 
   3.715575129662098*^9}},ExpressionUUID->"e559eda7-0615-4c03-ab57-\
68b5bc8c1fe2"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.71557388133687*^9, 
  3.71557388771544*^9}},ExpressionUUID->"4ecae200-f83c-4cd5-86b4-\
840c5af772b9"]
},
WindowSize->{1078, 656},
WindowMargins->{{22, Automatic}, {Automatic, 26}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 27, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 196, 4, 32, "Input", "ExpressionUUID" -> \
"211c148f-e3a3-4863-b726-8f62e589388b"],
Cell[757, 26, 5873, 121, 474, "Input", "ExpressionUUID" -> \
"bcf1e579-fe1f-4307-8b76-3f6471f9035d"],
Cell[CellGroupData[{
Cell[6655, 151, 3705, 86, 396, "Input", "ExpressionUUID" -> \
"8afb3927-b920-4bec-9b3c-f1fd4d6f7b78"],
Cell[10363, 239, 407, 7, 32, "Output", "ExpressionUUID" -> \
"8815a84e-6538-4a46-b6f5-dabc3dd98996"],
Cell[10773, 248, 417, 7, 32, "Output", "ExpressionUUID" -> \
"39710e87-40d7-4ffa-ac43-6d198717baae"],
Cell[11193, 257, 407, 7, 32, "Output", "ExpressionUUID" -> \
"c418f330-b4e6-4949-bfe5-83b812570087"],
Cell[11603, 266, 418, 7, 32, "Output", "ExpressionUUID" -> \
"87c2b33e-e702-4af2-a1ae-e9458d7e60c2"],
Cell[12024, 275, 407, 7, 32, "Output", "ExpressionUUID" -> \
"63edc929-4e27-4d78-928f-088dd25a94c1"],
Cell[12434, 284, 438, 7, 32, "Output", "ExpressionUUID" -> \
"154dec27-654b-4741-a844-62d9aae99876"],
Cell[12875, 293, 414, 7, 32, "Output", "ExpressionUUID" -> \
"7d630e82-2d81-435b-aad1-45a5843f863f"],
Cell[13292, 302, 830, 15, 88, "Output", "ExpressionUUID" -> \
"e559eda7-0615-4c03-ab57-68b5bc8c1fe2"]
}, Open  ]],
Cell[14137, 320, 150, 3, 32, "Input", "ExpressionUUID" -> \
"4ecae200-f83c-4cd5-86b4-840c5af772b9"]
}
]
*)

